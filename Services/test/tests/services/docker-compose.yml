version: '3.3'
services:
  test_client:
    image: newg_test_services/test_client
    build: ./../../test_client
    environment:
      - LOG_LEVEL=debug
    volumes:
      - ./../../test_client/app:/app
      - ./../../../.libservices:/usr/local/lib/node_modules/libservices
    depends_on:
      - matching
      - mindlink

  matching:
    image: newg_test_services/test_matching
    build: ./../../../matching
    environment:
      - LOG_LEVEL=debug
    volumes:
      - ./../../../matching/app:/app
      - ./../../../.libservices:/usr/local/lib/node_modules/libservices
    depends_on:
      - mindlink
      - api

  api:
    image: newg_test_services/test_api
    build: ./../../../api
    environment:
      - LOG_LEVEL=debug
    volumes:
      - ./../../../api/app:/app
      - ./../../../.libservices:/usr/local/lib/node_modules/libservices
    depends_on:
      - mindlink
      - couchdb
      - redis

  mindlink:
    image: nunun/mindlink
    depends_on:
      - rabbitmq

  rabbitmq:
    image: rabbitmq:3.7.0-management-alpine
    ports:
      - 15672:15672

  couchdb:
    image: couchdb:2.1.1

  redis:
    image: redis:4.0.6-alpine

