version: '3.3'
services:
  test-services-library-client:
    image: newg-test-services-library/test-services-library-client
    build: ./../../test-services-library-client
    environment:
      - LOG_LEVEL=debug
    volumes:
      - ./../../test-services-library-client/app:/app
      - ./../../../services-library:/usr/local/lib/node_modules/services-library
    depends_on:
      - mindlink1
      - mindlink2
      - test-services-library-server
      - couchdb
      - redis

  test-services-library-server:
    image: newg-test-services-library/test-services-library-server
    build: ./../../test-services-library-server
    environment:
      - LOG_LEVEL=debug
    volumes:
      - ./../../test-services-library-server/app:/app
      - ./../../../services-library:/usr/local/lib/node_modules/services-library

  mindlink1:
    image: newg-test-services-library/mindlink
    build: ./../../../mindlink
    environment:
      - DEBUG_HTTP_CHANNEL_ENABLE=1
      - LOG_LEVEL=debug
    volumes:
      - ./../../../mindlink/app:/app
      - ./../../../services-library:/usr/local/lib/node_modules/services-library
    ports:
      - 17766:17766
    depends_on:
      - rabbitmq

  mindlink2:
    image: newg-test-services-library/mindlink
    environment:
      - DEBUG_HTTP_CHANNEL_ENABLE=1
      - LOG_LEVEL=debug
    volumes:
      - ./../../../mindlink/app:/app
      - ./../../../services-library:/usr/local/lib/node_modules/services-library
    ports:
      - 17767:17766
    depends_on:
      - rabbitmq

  rabbitmq:
    image: rabbitmq:3.7.0-management-alpine
    ports:
      - 15672:15672

  couchdb:
    image: couchdb:2.1.1

  redis:
    image: redis:4.0.6-alpine

